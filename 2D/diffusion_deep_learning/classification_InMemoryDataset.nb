Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
  "(*", "\:3053\:306e\:30d5\:30a1\:30a4\:30eb\:306e\:30b3\:30fc\:30c9\:3067\
\:306f\:6709\:9650\:8981\:7d20\:6cd5\:306b\:3088\:308a\:62e1\:6563\:65b9\:7a0b\
\:5f0f\:3092\:89e3\:3044\:305f\:7d50\:679c\:306e\:525b\:6027\:884c\:5217\:304b\
\:3089\:96a3\:63a5\:884c\:5217\:3092\:5dee\:7656\:3059\:308b", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.787640882311607*^9, 3.787640970544245*^9}, {
  3.788250106962672*^9, 3.788250147247916*^9}, {3.800583147266274*^9, 
  3.800583149670102*^9}},
 FontFamily->"Source Code Pro",
 FontSize->12,
 FontWeight->
  "SemiBold",ExpressionUUID->"239d2c97-00e3-42ac-b2d3-1fcf32ecf8f4"],

Cell[CellGroupData[{

Cell["1~9 \:306e\:6570\:5b57 (+\:30a4\:30f3\:30ec\:30c3\:30c8) \:306e\:9818\
\:57df\:3092\:4f5c\:6210\:3059\:308b", "Section",
 CellChangeTimes->{{3.8005835019999933`*^9, 3.8005835984650297`*^9}, {
  3.800584390584828*^9, 
  3.8005843935713863`*^9}},ExpressionUUID->"030a1874-706a-4761-b804-\
0503dc1b2560"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"inletPosition", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1.2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.3", ",", "2"}], "}"}]}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "gives", " ", "the", " ", "dimensions", " ", "of", " ", "the",
     " ", "inlet"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inlet", "=", 
   RowBox[{"Rectangle", "@@", "inletPosition"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listRegion", "=", 
   RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"t", "=", 
       RowBox[{"Text", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"char", ",", "Bold"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalOmega]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"RegionUnion", "[", 
            RowBox[{"inlet", ",", "#"}], "]"}], "&"}], "@", 
          RowBox[{"TransformedRegion", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{"0.5", "*", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Indexed", "[", 
                   RowBox[{"#", ",", "1"}], "]"}], "+", "0"}], ")"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Indexed", "[", 
                   RowBox[{"#", ",", "2"}], "]"}], "+", "0"}], ")"}]}], 
               "}"}]}], "&"}]}], "]"}]}], "&"}], "@", 
        RowBox[{"BoundaryDiscretizeGraphics", "[", 
         RowBox[{"t", ",", "_Text", ",", 
          RowBox[{"MaxCellMeasure", "\[Rule]", "0.03"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"char", ",", 
       RowBox[{"ToString", "/@", 
        RowBox[{"Range", "@", "9"}]}]}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.800583468082177*^9, 3.800583470195197*^9}, 
   3.800583557687129*^9, {3.800583661713832*^9, 3.8005836727528887`*^9}, {
   3.800583814784424*^9, 3.800583819573986*^9}, {3.800584159483075*^9, 
   3.800584161246406*^9}, 3.8005842175215397`*^9, {3.8005855908922987`*^9, 
   3.800585594896637*^9}, {3.800585731547781*^9, 3.800585732875908*^9}, {
   3.80059443947253*^9, 3.800594439779969*^9}, 3.803483966452868*^9, {
   3.803509231529306*^9, 3.8035092331319313`*^9}, {3.8040436553948*^9, 
   3.8040436840439796`*^9}, {3.804044861144216*^9, 3.80404487906063*^9}, {
   3.804044946421777*^9, 3.804044969686367*^9}, {3.804045006122707*^9, 
   3.80404500869666*^9}, {3.80404507107472*^9, 3.8040451714765053`*^9}, {
   3.804045210079245*^9, 3.804045291926817*^9}, {3.805379913274623*^9, 
   3.805379919670434*^9}, 3.805383930152975*^9, {3.8053840824612083`*^9, 
   3.805384082702355*^9}, 3.80542275396452*^9},
 CellLabel->"In[304]:=",ExpressionUUID->"8f47ff15-3667-4d4b-9c17-4299714c289b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "\:4f5c\:6210\:3057\:305f\:5168\:9818\:57df\:306e\:96a3\:63a5\:884c\:5217\
\:3092\:4e00\:62ec\:3067\:4f5c\:6210\:3059\:308b\n",
 StyleBox["\:6570\:5b57\:306e1~9 \:304b\:3089\:751f\:6210\:3057\:305f\:9818\
\:57df\:306bnBeads\:500b\:306e\:70b9\:3092\:30e9\:30f3\:30c0\:30e0\:306b\:914d\
\:7f6e\:3057\:ff0c\:305d\:308c\:305e\:308c\:306e\:6570\:5b57\:306b\:5bfe\:3057\
\:3066nSample\:500b\:306e\:96a3\:63a5\:884c\:5217\:3092\:4f5c\:308b\:ff0e\n\
\:3053\:308c\:3089\:306e\:96a3\:63a5\:884c\:5217\:3092\:30c7\:30fc\:30bf\:30bb\
\:30c3\:30c8\:3068\:3057\:3066\:96a3\:63a5\:884c\:5217\:304c\:3069\:306e\:6570\
\:5b57\:304b\:3089\:5f97\:3089\:308c\:305f\:3082\:306e\:304b\:3092\:63a8\:5b9a\
\:3059\:308b\:306e\:304c\:4eca\:56de\:306e\:76ee\:7684\:ff0e", "Text"]
}], "Section",
 CellChangeTimes->{{3.800583612027554*^9, 3.8005836392043257`*^9}, 
   3.800583679617476*^9, {3.800589453673171*^9, 3.800589455044096*^9}, {
   3.800589671503305*^9, 
   3.800589672732765*^9}},ExpressionUUID->"d24a5f42-df8d-43d8-82f1-\
c8395823f38c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:8981\:7d20\:6570\:306fMaxCellMeasure\:3092\:5909\:3048\:3066\:3082\
\:3042\:307e\:308a\:5909\:308f\:3089\:306a\:3044\:306e\:3067\:56fa\:5b9a\:3059\
\:308b", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"testRun", " ", "=", " ", "True"}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"nBeads", "=", 
     RowBox[{"If", "[", 
      RowBox[{"testRun", ",", " ", "10", ",", "100"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nSample", "=", 
     RowBox[{"If", "[", 
      RowBox[{"testRun", ",", "2", ",", "5000"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"addNoise", "=", "False"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"noiseRatio", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Fixed", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellSize", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"t", "=", "20"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"prefix", "=", 
     RowBox[{"If", "[", 
      RowBox[{"testRun", ",", "\"\<small_\>\"", ",", "\"\<large_\>\""}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:5b58\:5728\:3057\:306a\:3044\:6642\:306f\:30c7\:30a3\:30ec\:30af\
\:30c8\:30ea\:3092\:81ea\:52d5\:4f5c\:6210\:3059\:308b", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"exportDirectory", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<data\>\"", ",", 
        RowBox[{"prefix", "<>", "\"\<classification_InMemoryDataset\>\""}], 
        ",", "\"\<raw\>\""}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CreateDirectory", "@", "exportDirectory"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timeFunc", "=", 
     RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"graphs", "=", 
        RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "rotRatio", ",", "xScRatio", ",", "yScRatio", ",", "xAffRatio", 
              ",", "yAffRatio"}], "}"}], "=", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "noiseRatio"}], ",", "noiseRatio"}], "}"}], ",", 
              
              RowBox[{"{", "5", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           
           RowBox[{"rTrans", "=", 
            RowBox[{"RotationTransform", "[", 
             RowBox[{"2", "*", "Pi", "*", "rotRatio"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"scTrans", "=", 
            RowBox[{"ScalingTransform", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"1", "+", "xScRatio"}], ",", 
               RowBox[{"1", "+", "yScRatio"}]}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "x", ",", 
             "y\:8ef8\:306e\:4e21\:65b9\:526a\:65ad\:5909\:5f62\:3059\:308b"}]\
, "*)"}], "\[IndentingNewLine]", 
           RowBox[{"affTrans", "=", 
            RowBox[{"AffineTransform", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"Tan", "[", 
                  RowBox[{"xAffRatio", "*", "Pi"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Tan", "[", 
                  RowBox[{"yAffRatio", "*", "Pi"}], "]"}], ",", "1"}], 
                "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"transform", "=", 
            RowBox[{"Composition", "[", 
             RowBox[{"rTrans", ",", "affTrans", ",", "scTrans"}], "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"\[CapitalOmega]", "=", 
            RowBox[{"If", "[", 
             RowBox[{"addNoise", ",", 
              RowBox[{"TransformedRegion", "[", 
               RowBox[{
                RowBox[{"listRegion", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "transform"}], "]"}], 
              ",", 
              RowBox[{"listRegion", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"maxcellsize", "=", "cellSize"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"nr", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"ToElementMesh", "[", 
               RowBox[{"#", ",", 
                RowBox[{"MaxCellMeasure", "\[Rule]", "maxcellsize"}]}], "]"}],
               "&"}], "@", 
             RowBox[{"BoundaryDiscretizeRegion", "@", "\[CapitalOmega]"}]}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"vd", "=", 
            RowBox[{"NDSolve`VariableData", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<DependentVariables\>\"", "\[Rule]", 
                RowBox[{"{", "u", "}"}]}], ",", 
               RowBox[{"\"\<Space\>\"", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"x", ",", "y"}], "}"}]}]}], "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"sd", "=", 
            RowBox[{"NDSolve`SolutionData", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Space\>\"", "\[Rule]", "nr"}], "}"}], "]"}]}], ";",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"coefficients", "=", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\"\<DiffusionCoefficients\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"IdentityMatrix", "[", "2", "]"}], "}"}], "}"}]}], 
              ",", 
              RowBox[{"\"\<DampingCoefficients\>\"", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}]}]}], "}"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"initCoeffs", "=", 
            RowBox[{"InitializePDECoefficients", "[", 
             RowBox[{"vd", ",", "sd", ",", "coefficients"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"methodData", "=", 
            RowBox[{"InitializePDEMethodData", "[", 
             RowBox[{"vd", ",", "sd"}], "]"}]}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Assembly", " ", "of", " ", "matrices"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"discretePDE", "=", 
            RowBox[{"DiscretizePDE", "[", 
             RowBox[{"initCoeffs", ",", "methodData", ",", "sd"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"load", ",", "stiffness", ",", "damping", ",", "mass"}], 
             "}"}], "=", 
            RowBox[{"discretePDE", "[", "\"\<SystemMatrices\>\"", "]"}]}], 
           ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"e", "-", 
             RowBox[{
             "^", "tM\:3092\:96a3\:63a5\:884c\:5217\:3068\:307f\:306a\:3059\
\:5834\:5408\:306f\:8981\:7d20\:306e\:9802\:70b9\:6570\:3068\:540c\:3058\:6570\
\:306e\:7a2e\:985e\:306e\:30d3\:30fc\:30ba\:3092\:4f7f\:3046\:3053\:3068\:3092\
\:4eee\:5b9a\:3057\:3066\:3044\:308b"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
           "(*", "\:6b21\:5143\:304c\:5927\:304d\:3044\:3068\:884c\:5217\:306e\
\:6307\:6570\:95a2\:6570\:3092\:8a08\:7b97\:3059\:308b\:306e\:304c\:5927\:5909\
\:306a\:306e\:3067\:7528\:3044\:305f\:30d3\:30fc\:30ba\:306e\:7a2e\:985e\:306b\
\:6b21\:5143\:3092\:7e2e\:3081\:308b", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"n", "=", 
            RowBox[{"Length", "@", "stiffness"}]}], ";", "  ", 
           RowBox[{"(*", "\:8981\:7d20\:6570", "*)"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "\:7c21\:5358\:306e\:305f\:3081\:30d3\:30fc\:30ba\:306f\:63a5\
\:70b9\:4e0a\:306b\:914d\:7f6e\:3055\:308c\:308b\:3068\:4eee\:5b9a", "\:ff0e",
              "\:8981\:7d20\:5185\:90e8\:3078\:306e\:914d\:7f6e\:3082\:8a8d\
\:3081\:308b\:306b\:306f\:6fc3\:5ea6", "\:ff0c", 
             "\:5ea7\:6a19\:306e\:8a2d\:5b9a\:6642\:306b\:4f55\:304b\:3057\
\:3089\:88dc\:5b8c\:3059\:308b\:5fc5\:8981\:304c\:3042\:308b"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
           "(*", "\:6700\:521d\:306b\:30d3\:30fc\:30ba\:3092\:914d\:7f6e\:3059\
\:308b\:7bc0\:70b9\:306e\:30a4\:30f3\:30c7\:30c3\:30af\:30b9\:3092\:91cd\:8907\
\:306e\:306a\:3044\:3088\:3046\:306b\:7528\:3044\:308b\:30d3\:30fc\:30ba\:306e\
\:6570\:3060\:3051\:30e9\:30f3\:30c0\:30e0\:306b\:9078\:3076", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"iInitialPoints", "=", 
            RowBox[{"RandomSample", "[", 
             RowBox[{
              RowBox[{"Range", "[", "n", "]"}], ",", "nBeads"}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "i\:756a\:76ee\:306e\:30d3\:30fc\:30ba\:306e\:9818\:57df\:306b\
\:521d\:671f\:6fc3\:5ea6\:3092", 
             RowBox[{"(", 
              RowBox[{"1", ",", "\:8981\:7d20\:6570"}], ")"}], 
             "\:306ei\:756a\:76ee\:3060\:3051\:304c1\:306e\:5358\:4f4d\:30d9\
\:30af\:30c8\:30eb\:3068\:3057\:3066\:8868\:3057\:3066\:3044\:308b", 
             "\[IndentingNewLine]", 
             "\:305d\:306e\:3088\:3046\:306a\:5358\:4f4d\:30d9\:30af\:30c8\
\:30eb\:3092\:30d3\:30fc\:30ba\:306e\:7a2e\:985e\:6570\:3060\:3051\:96c6\:3081\
\:3066\:884c\:5217V\:3092\:5f62\:6210\:3057\:3066\:3044\:308b"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"transC0", "=", 
            RowBox[{"SparseArray", "@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"UnitVector", "[", 
                RowBox[{"n", ",", 
                 RowBox[{"iInitialPoints", "[", 
                  RowBox[{"[", "iBead", "]"}], "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"iBead", ",", "nBeads"}], "}"}]}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"\:525b\:6027\:884c\:5217stiffness\:306f", 
             RowBox[{"(", 
              RowBox[{"\:8981\:7d20\:6570", ",", "\:8981\:7d20\:6570"}], 
              ")"}], "\:3068\:975e\:5e38\:306b\:5927\:304d\:3044\:306e\:3067\
\:305d\:306e\:307e\:307e\:6307\:6570\:884c\:5217\:3092\:8a08\:7b97\:3059\:308b\
\:306e\:306f\:5927\:5909", "\[IndentingNewLine]", 
             "\:305d\:3053\:3067mathematica\:306e\:6a5f\:80fd\:306b\:3088\
\:308a\:3042\:3089\:304b\:3058\:3081C0\:3092\:304b\:3051\:308b\:3053\:3068\
\:3067\:6b21\:5143\:3092\:6e1b\:3089\:3057\:8a08\:7b97\:91cf\:306e\:4f4e\:6e1b\
\:3057\:3066\:3044\:308b"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"transCt", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Chop", "@", 
               RowBox[{"SparseArray", "@", 
                RowBox[{"MatrixExp", "[", 
                 RowBox[{
                  RowBox[{"t", "*", 
                   RowBox[{"SparseArray", "@", "stiffness"}]}], ",", "#"}], 
                 "]"}]}]}], "&"}], "/@", "transC0"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "\:96a3\:63a5\:884c\:5217\:3092\:8a08\:7b97\:3057\:305f\:5f8c", 
             "\:ff0c", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", ",", 
                RowBox[{"\:30d3\:30fc\:30ba\:6570", "^", "2"}]}], ")"}], 
              "\:306b\:6574\:5f62\:3057"}], "\:ff0c", 
             RowBox[{
             "\:6700\:5f8c\:306b\:30bf\:30fc\:30b2\:30c3\:30c8\:306e\:756a\
\:53f7", 
              RowBox[{"(", 
               RowBox[{"1", "~", "9"}], ")"}], 
              "\:3092\:8ffd\:52a0\:3059\:308b"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{"transCt", ".", 
             RowBox[{"Transpose", "[", "transCt", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
           "(*", "\:5bfe\:89d2\:6210\:5206\:30920\:306b\:3059\:308b\:3053\
\:3068\:3067\:30eb\:30fc\:30d7\:3092\:9664\:5916\:3059\:308b", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"A", "=", 
            RowBox[{"A", "-", 
             RowBox[{"DiagonalMatrix", "[", 
              RowBox[{"Diagonal", "[", "A", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"\:96a3\:63a5\:884c\:5217\:306e1", "/", "n"}], 
             RowBox[{
             "(", "\:5b9a\:5e38\:614b\:306e\:6642\:96a3\:63a5\:884c\:5217\
\:306e\:8981\:7d20", ")"}], 
             "\:3088\:308a\:5c0f\:3055\:3044\:8981\:7d20\:30920\:306b\:7f6e\
\:304d\:63db\:3048\:308b"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"adjMat", "=", 
            RowBox[{"Chop", "[", 
             RowBox[{"A", ",", 
              RowBox[{"1.0", "/", "n"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "\:3068\:308a\:3042\:3048\:305amtx\:3067\:51fa\:529b\:3059\:308b\
\:305f\:3081\:306b\:305d\:308c\:305e\:308c\:6700\:7d42\:7684\:306b2\:6b21\
\:5143\:306b\:306a\:308b\:3088\:3046\:306b\:3059\:308b", "\:ff0e", 
             "\:30b0\:30e9\:30d5\:3054\:3068\:306b\:30d5\:30a1\:30a4\:30eb\
\:306b\:5206\:3051\:308b\:306a\:3069\:30c7\:30fc\:30bf\:69cb\:9020\:306e\:691c\
\:8a0e\:306f\:4eca\:5f8c\:884c\:3046"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Flatten", "@", "adjMat"}], ",", 
             RowBox[{"{", "i", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          "nSample", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "listRegion"}]}]}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"graphs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"graphs", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"adjMats", "=", 
        RowBox[{"graphs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"classes", "=", 
        RowBox[{"graphs", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"exportDirectory", ",", "\"\<adjMats.mtx\>\""}], "}"}], 
          "]"}], ",", 
         RowBox[{"SparseArray", "@", "adjMats"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"FileNameJoin", "[", 
          RowBox[{"{", 
           RowBox[{"exportDirectory", ",", "\"\<classes.mtx\>\""}], "}"}], 
          "]"}], ",", "classes"}], "]"}], ";"}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:5b9f\:9a13\:6761\:4ef6\:30fb\:6240\:8981\:6642\:9593\:306e\:8868\
\:793a", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "@", "\"\<=====Simulation conditions=====\>\""}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Number of beads: \>\"", "<>", 
     RowBox[{"ToString", "@", "nBeads"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Number of samples for each shape: \>\"", "<>", 
     RowBox[{"ToString", "@", "nSample"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Noise ratio: \>\"", "<>", 
     RowBox[{"ToString", "@", "noiseRatio"}]}], "]"}], "\[IndentingNewLine]", 
   
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Diffusion time: \>\"", "<>", 
     RowBox[{"ToString", "@", "t"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Test run: \>\"", "<>", 
     RowBox[{"ToString", "@", "testRun"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "@", "\"\<=====Calculation time======\>\""}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"elapsedTime", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"UnitConvert", "[", 
        RowBox[{
         RowBox[{"Quantity", "[", 
          RowBox[{"#", ",", "\"\<Seconds\>\""}], "]"}], ",", 
         RowBox[{"MixedRadix", "[", 
          RowBox[{
          "\"\<Hours\>\"", ",", "\"\<Minutes\>\"", ",", "\"\<Seconds\>\""}], 
          "]"}]}], "]"}], "&"}], "@", 
      RowBox[{"timeFunc", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Elapsed time: \>\"", "<>", 
     RowBox[{"ToString", "@", "elapsedTime"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.785139042974595*^9, 3.785139160369553*^9}, {
   3.7851392109705553`*^9, 3.785139252294373*^9}, {3.785139291391139*^9, 
   3.785139293348325*^9}, 3.785161333536604*^9, {3.7851614364396276`*^9, 
   3.785161462817931*^9}, {3.785161499771172*^9, 3.785161520376851*^9}, {
   3.785161581189919*^9, 3.7851616793404627`*^9}, {3.7851619524189663`*^9, 
   3.7851620249949837`*^9}, {3.785162246265752*^9, 3.785162298389715*^9}, {
   3.785162348698781*^9, 3.785162380602148*^9}, {3.785162425202424*^9, 
   3.78516244286031*^9}, {3.785162617389834*^9, 3.7851626235866003`*^9}, {
   3.7851634725763493`*^9, 3.7851635420787992`*^9}, {3.785191614264203*^9, 
   3.785191684293005*^9}, {3.785191959343997*^9, 3.7851920134719257`*^9}, {
   3.785192046286326*^9, 3.785192072028125*^9}, {3.7851923004312353`*^9, 
   3.7851923051932573`*^9}, 3.785192559855977*^9, {3.7851925930622787`*^9, 
   3.785192604297043*^9}, {3.785192660755106*^9, 3.785192670504987*^9}, {
   3.7851998707682323`*^9, 3.785199878105403*^9}, {3.785204024225567*^9, 
   3.7852044390511436`*^9}, {3.7852044698671637`*^9, 3.785204556010035*^9}, {
   3.785204591800961*^9, 3.785204669004284*^9}, {3.785204706639123*^9, 
   3.7852047274624968`*^9}, {3.785204767832614*^9, 3.785204782836956*^9}, {
   3.785204825323591*^9, 3.7852048488375*^9}, {3.785204887910961*^9, 
   3.7852048958599243`*^9}, {3.785215899355348*^9, 3.785215907153739*^9}, {
   3.785217303972459*^9, 3.7852174074616747`*^9}, 3.785217560624461*^9, {
   3.785217600038364*^9, 3.785217611336418*^9}, 3.78521779563697*^9, {
   3.78521871916997*^9, 3.78521875372118*^9}, 3.7852187995785723`*^9, {
   3.785218939133107*^9, 3.785218946573262*^9}, {3.7852193713384113`*^9, 
   3.785219393712511*^9}, {3.7852327848266487`*^9, 3.78523278653622*^9}, {
   3.7852329232001657`*^9, 3.785232923494923*^9}, {3.7852968954672823`*^9, 
   3.7852969003322287`*^9}, {3.7854610871641893`*^9, 
   3.7854611011322613`*^9}, {3.785461341434822*^9, 3.785461376094824*^9}, {
   3.785461413767078*^9, 3.7854614196379633`*^9}, 3.785463096721052*^9, {
   3.785463525720841*^9, 3.7854635293358393`*^9}, {3.785463578802576*^9, 
   3.785463634896469*^9}, {3.7854638680792*^9, 3.785463872197961*^9}, {
   3.7854639099884777`*^9, 3.7854639163244457`*^9}, {3.785465941051737*^9, 
   3.785465961120985*^9}, {3.785466270010993*^9, 3.7854662921725597`*^9}, {
   3.7854710807028008`*^9, 3.785471091206263*^9}, {3.785471125203664*^9, 
   3.785471195886221*^9}, {3.785471434440917*^9, 3.785471456120356*^9}, {
   3.785471605608329*^9, 3.785471771605879*^9}, {3.785471823675275*^9, 
   3.7854718435341797`*^9}, {3.785471880613879*^9, 3.785471922610548*^9}, {
   3.7854719737889423`*^9, 3.7854719776837053`*^9}, {3.785472028998198*^9, 
   3.785472046263591*^9}, {3.785472081533916*^9, 3.785472084084482*^9}, {
   3.785472170144903*^9, 3.78547217668426*^9}, {3.788245646419083*^9, 
   3.788245672822802*^9}, {3.788253843101926*^9, 3.78825387042966*^9}, {
   3.7882542799428263`*^9, 3.788254286822878*^9}, {3.788254490359498*^9, 
   3.7882546591710777`*^9}, 3.788254700616495*^9, {3.788254741102209*^9, 
   3.7882547632330513`*^9}, {3.788254794966012*^9, 3.7882547981102123`*^9}, {
   3.788254905400631*^9, 3.788254938252014*^9}, {3.78825517051897*^9, 
   3.788255231936754*^9}, 3.788255272198669*^9, {3.788255304724764*^9, 
   3.788255305075439*^9}, {3.788255342081327*^9, 3.7882553478425827`*^9}, {
   3.788255600392766*^9, 3.788255747544031*^9}, {3.788255791551756*^9, 
   3.788255859408525*^9}, {3.788476836282209*^9, 3.788476849095861*^9}, 
   3.788476883941948*^9, {3.788482596511077*^9, 3.788482650507297*^9}, 
   3.7884826961254683`*^9, {3.788485355818554*^9, 3.788485380590184*^9}, 
   3.7884854583825903`*^9, {3.788495459010641*^9, 3.7884954947371407`*^9}, {
   3.788495533422976*^9, 3.7884955374623833`*^9}, {3.788495608481954*^9, 
   3.7884956905596724`*^9}, {3.788495795640314*^9, 3.788495798319655*^9}, {
   3.788495828500194*^9, 3.7884958774515467`*^9}, {3.78849600252203*^9, 
   3.788496017601465*^9}, 3.78882450150628*^9, 3.789092447534172*^9, 
   3.8005836062153463`*^9, 3.800583644132847*^9, {3.800584832234804*^9, 
   3.8005848324034863`*^9}, 3.800586143892624*^9, {3.800586359782651*^9, 
   3.800586373649208*^9}, 3.8005880012745237`*^9, 3.800588107348391*^9, {
   3.800588287301935*^9, 3.800588420393178*^9}, 3.800588477716756*^9, {
   3.80058851842179*^9, 3.800588633006588*^9}, {3.8005886870100307`*^9, 
   3.800588690469267*^9}, {3.8005888778347588`*^9, 3.8005888859103947`*^9}, {
   3.800589282261056*^9, 3.800589418828946*^9}, 3.8005895789716787`*^9, {
   3.800589821372282*^9, 3.8005898226459417`*^9}, 3.800590082923546*^9, 
   3.800590120711493*^9, {3.800590170679564*^9, 3.8005902607212553`*^9}, {
   3.800590515479594*^9, 3.800590633640236*^9}, {3.8005908689010477`*^9, 
   3.800590885682644*^9}, {3.800590923048067*^9, 3.800590951982724*^9}, {
   3.800590995003934*^9, 3.800591006179298*^9}, 3.8005919264429827`*^9, {
   3.800593008219232*^9, 3.800593050375451*^9}, 3.800593088598489*^9, {
   3.8005931209997396`*^9, 3.80059315082572*^9}, {3.800593218282775*^9, 
   3.8005932693194513`*^9}, 3.800593345714942*^9, {3.800593420907177*^9, 
   3.800593440920087*^9}, {3.8005934824544687`*^9, 3.800593496787508*^9}, {
   3.800593533955262*^9, 3.800593589596777*^9}, {3.800593624382044*^9, 
   3.800593625389839*^9}, {3.8005937612949657`*^9, 3.800593808979155*^9}, {
   3.800593881028963*^9, 3.800593927133905*^9}, {3.800594532426486*^9, 
   3.800594596292227*^9}, {3.800594631320228*^9, 3.800594636798131*^9}, {
   3.800594667284275*^9, 3.800594670620946*^9}, {3.800594716421114*^9, 
   3.800594728866254*^9}, {3.8005947852000713`*^9, 3.8005947909636087`*^9}, {
   3.800594872031971*^9, 3.800594882489307*^9}, {3.800600478450693*^9, 
   3.8006004830488*^9}, {3.800611761135579*^9, 3.800611861735174*^9}, 
   3.800611905390264*^9, 3.8006510243740177`*^9, {3.800652801641101*^9, 
   3.80065283221688*^9}, 3.800652938355853*^9, {3.800652968415352*^9, 
   3.8006529713651333`*^9}, {3.800653006417881*^9, 3.800653009415594*^9}, {
   3.800653385622732*^9, 3.8006533873043633`*^9}, {3.80065410469906*^9, 
   3.8006541060960627`*^9}, {3.8006541456817503`*^9, 3.800654146923813*^9}, {
   3.8006541878976793`*^9, 3.800654227509564*^9}, {3.8034586242588882`*^9, 
   3.803458625498126*^9}, {3.80345874125845*^9, 3.803458833812977*^9}, 
   3.8034588740636473`*^9, {3.803468543207737*^9, 3.803468590479313*^9}, 
   3.803469208243703*^9, {3.8034836801399117`*^9, 3.803483692245316*^9}, {
   3.803483790138102*^9, 3.803483909120611*^9}, {3.803484057196827*^9, 
   3.803484058734272*^9}, {3.803484232309451*^9, 3.80348423590236*^9}, {
   3.803486273113385*^9, 3.803486273747764*^9}, {3.8034863482159843`*^9, 
   3.803486379767992*^9}, {3.803486610686417*^9, 3.803486615967246*^9}, {
   3.8035037717319393`*^9, 3.8035038242861557`*^9}, 3.803505955314618*^9, {
   3.803506224784411*^9, 3.803506291967765*^9}, {3.80350676161329*^9, 
   3.803506834402588*^9}, {3.803507328652421*^9, 3.8035074079334297`*^9}, {
   3.8035074419368887`*^9, 3.803507443007382*^9}, {3.803507475423424*^9, 
   3.8035075112496862`*^9}, {3.803507978401032*^9, 3.803508016877555*^9}, {
   3.8035084130774813`*^9, 3.803508487951252*^9}, {3.803508557705641*^9, 
   3.8035085680499907`*^9}, {3.803509013622712*^9, 3.8035090410555563`*^9}, {
   3.8035092841063957`*^9, 3.803509295509684*^9}, {3.8035094679889593`*^9, 
   3.803509622480178*^9}, 3.8035097519157124`*^9, {3.803510117763686*^9, 
   3.803510136897252*^9}, {3.8035103708880043`*^9, 3.803510376828561*^9}, 
   3.80351052223599*^9, {3.803510609733837*^9, 3.803510625878839*^9}, {
   3.803525868466715*^9, 3.803525967181067*^9}, {3.8035260332435713`*^9, 
   3.803526160544191*^9}, {3.803526396938752*^9, 3.8035264290218563`*^9}, 
   3.803526863604864*^9, 3.80352691784347*^9, {3.803526994773934*^9, 
   3.80352711279629*^9}, {3.8035271853240767`*^9, 3.803527279756542*^9}, {
   3.8035275285219927`*^9, 3.803527552647417*^9}, {3.803527627146862*^9, 
   3.8035276588609753`*^9}, {3.803527765340169*^9, 3.8035278487398643`*^9}, 
   3.803527944417807*^9, {3.803528066086053*^9, 3.80352808331813*^9}, {
   3.8035336276927233`*^9, 3.803533629614346*^9}, {3.803534405636932*^9, 
   3.803534431861981*^9}, {3.80355010658111*^9, 3.803550109052691*^9}, {
   3.804043900264805*^9, 3.804043971259172*^9}, {3.804044034054377*^9, 
   3.8040440699518633`*^9}, {3.804044106889751*^9, 3.804044171796517*^9}, {
   3.804044717533348*^9, 3.804044729644472*^9}, {3.804045317894206*^9, 
   3.8040453728434668`*^9}, {3.804045676626855*^9, 3.804045732916647*^9}, {
   3.804046126297744*^9, 3.804046189802518*^9}, {3.804046222559299*^9, 
   3.804046224533689*^9}, {3.8040462654804068`*^9, 3.80404629113903*^9}, {
   3.804048144858012*^9, 3.804048268217347*^9}, {3.80404830462213*^9, 
   3.804048380750587*^9}, {3.8040485296841307`*^9, 3.80404853987467*^9}, {
   3.804048577800826*^9, 3.80404860403384*^9}, 3.804048641864979*^9, 
   3.804048845539214*^9, 3.80443543553161*^9, {3.8053895996334953`*^9, 
   3.8053896001587563`*^9}, {3.805390557719043*^9, 3.8053906050415*^9}, {
   3.805390781946381*^9, 3.8053907882018633`*^9}, {3.8053908557674227`*^9, 
   3.805390956290161*^9}, {3.805391200097066*^9, 3.805391321127451*^9}, {
   3.8053913594592457`*^9, 3.805391372312028*^9}, {3.805391403592558*^9, 
   3.80539148832751*^9}, {3.805391532966004*^9, 3.805391534015449*^9}, {
   3.8053915966252937`*^9, 3.80539161158746*^9}, {3.805391953383259*^9, 
   3.805391993711876*^9}, {3.805392311055702*^9, 3.805392320458816*^9}, {
   3.805392539011257*^9, 3.805392541319564*^9}, {3.80539303536158*^9, 
   3.805393054611533*^9}, {3.80539315654981*^9, 3.805393212810111*^9}, {
   3.805393310088814*^9, 3.80539331043082*^9}, {3.8053947099797707`*^9, 
   3.805394796982209*^9}, {3.805395014236578*^9, 3.8053950446957073`*^9}, {
   3.805395298135186*^9, 3.805395388053186*^9}, {3.805395423516821*^9, 
   3.805395436724424*^9}, {3.805395476070242*^9, 3.805395488645317*^9}, {
   3.805395612551803*^9, 3.805395634877966*^9}, {3.805395959883647*^9, 
   3.805395961953415*^9}, {3.80539625604534*^9, 3.805396282814102*^9}, {
   3.805396411447201*^9, 3.805396412866447*^9}, {3.805419198286706*^9, 
   3.8054192240584297`*^9}, {3.805419466472281*^9, 3.8054194723388853`*^9}, {
   3.8054195846747723`*^9, 3.805419612995389*^9}, {3.805419772035331*^9, 
   3.8054197746275463`*^9}, {3.805422526329365*^9, 3.8054225361155567`*^9}, {
   3.805422639300849*^9, 3.8054226751880093`*^9}, {3.80542273150627*^9, 
   3.805422746562284*^9}, {3.805423392268711*^9, 3.805423395763659*^9}, {
   3.805423544774604*^9, 3.805423551442548*^9}, {3.8054236004468412`*^9, 
   3.805423612658704*^9}, {3.805424185230998*^9, 3.8054241982331553`*^9}, {
   3.805424374855733*^9, 3.805424401125071*^9}, {3.805424449877736*^9, 
   3.805424450853084*^9}, {3.8055341915208263`*^9, 3.8055341944981956`*^9}, {
   3.806101082484358*^9, 3.806101130669673*^9}, {3.806206726047119*^9, 
   3.8062067363923397`*^9}, {3.8062067746543922`*^9, 3.806206824488373*^9}, {
   3.806251256022331*^9, 3.806251351207698*^9}, {3.806251399914899*^9, 
   3.806251412528267*^9}, 3.806251545323913*^9, {3.806251579610894*^9, 
   3.806251602211718*^9}, {3.8062516502522707`*^9, 3.806251673724701*^9}, {
   3.806251900980337*^9, 3.806252074918871*^9}, {3.8062521695439177`*^9, 
   3.806252181650234*^9}, {3.806252227589287*^9, 3.806252258346684*^9}, {
   3.806252293309312*^9, 3.806252296578342*^9}, {3.806252355756822*^9, 
   3.8062523565503607`*^9}, {3.806252457342554*^9, 3.806252462943695*^9}, {
   3.806252519134996*^9, 3.806252536958754*^9}, 3.806252592804924*^9, {
   3.8062526393012543`*^9, 3.806252661675345*^9}, {3.806252794133786*^9, 
   3.806252794567465*^9}, {3.806252842259817*^9, 3.80625284276285*^9}, {
   3.806252873058297*^9, 3.806252902116817*^9}, {3.8062530060775642`*^9, 
   3.8062530835750637`*^9}, {3.80625311397015*^9, 3.8062531431019793`*^9}, {
   3.806253330184164*^9, 3.806253331133843*^9}, {3.80625480630753*^9, 
   3.8062548117995033`*^9}, {3.806254869898528*^9, 3.80625501936399*^9}, {
   3.806255473467614*^9, 3.8062555582035522`*^9}, {3.806255612215453*^9, 
   3.8062556891232967`*^9}, {3.806256262721878*^9, 3.8062563201305847`*^9}, {
   3.80625694360209*^9, 3.806256957008539*^9}, {3.8062569989784737`*^9, 
   3.8062570052111883`*^9}, {3.80634182354077*^9, 3.8063418389277773`*^9}, {
   3.806343539432578*^9, 3.806343542615052*^9}, {3.8070397524512444`*^9, 
   3.8070397576100388`*^9}},
 FontFamily->"Source Code Pro",
 FontSize->12,
 FontWeight->"SemiBold",ExpressionUUID->"d0c3848f-a082-4bf5-95e6-818c5f99c3d4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["\:4f5c\:6210\:3057\:305f\:9818\:57df\:306e\:8868\:793a\
 \:ff08\:78ba\:8a8d\:ff09", "Section"]], "Section",
 CellChangeTimes->{{3.800584167443825*^9, 
  3.800584193511612*^9}},ExpressionUUID->"157cf1e5-ec16-4eda-8d2c-\
e9cac67e3ac0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Region", "[", 
        RowBox[{"#", ",", 
         RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "&"}], "@", 
      RowBox[{"RegionUnion", "[", 
       RowBox[{"inlet", ",", "#"}], "]"}]}], "&"}], "/@", "listRegion"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Region", "[", 
        RowBox[{"#", ",", 
         RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "&"}], "@", 
      RowBox[{"RegionUnion", "[", 
       RowBox[{"inlet", ",", "#"}], "]"}]}], "&"}], "/@", "listRegion"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Region", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "&"}], "/@", 
   "listRegion"}]}]], "Input",
 CellChangeTimes->{{3.800584200863413*^9, 3.800584205806817*^9}, {
   3.800584269817502*^9, 3.800584279413494*^9}, {3.800585616187458*^9, 
   3.8005856227676487`*^9}, {3.800585703918503*^9, 3.800585724953314*^9}, 
   3.800594425899144*^9, {3.804043709926916*^9, 3.804043717081295*^9}, {
   3.804043788299499*^9, 3.804043827288537*^9}, {3.804044791344001*^9, 
   3.804044841088084*^9}, 3.805005102811141*^9, {3.8050054701580267`*^9, 
   3.8050054858163157`*^9}, {3.8055333742147493`*^9, 3.805533453427083*^9}},
 CellLabel->
  "In[56]:=",ExpressionUUID->"9d9c1c5f-e099-4114-bbf6-aacdca2a90dd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:5f62\:72b6\:306b\:30ce\:30a4\:30ba\:3092\:4e0e\:3048\:305f\:969b\:306e\
\:30b5\:30f3\:30d7\:30eb", "Section",
 CellChangeTimes->{{3.805531545366593*^9, 
  3.805531569672352*^9}},ExpressionUUID->"7f0a924a-2496-40c2-8a78-\
b8394f759061"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nSample", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"noiseRatio", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rotRatio", ",", "xScRatio", ",", "yScRatio", ",", "xAffRatio", ",", 
       "yAffRatio"}], "}"}], "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "noiseRatio"}], ",", "noiseRatio"}], "}"}], ",", 
       RowBox[{"{", "5", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rTrans", "=", 
     RowBox[{"RotationTransform", "[", 
      RowBox[{"2", "*", "Pi", "*", "rotRatio"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"scTrans", "=", 
     RowBox[{"ScalingTransform", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "+", "xScRatio"}], ",", 
        RowBox[{"1", "+", "yScRatio"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "x", ",", 
      "y\:8ef8\:306e\:4e21\:65b9\:526a\:65ad\:5909\:5f62\:3059\:308b"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"affTrans", "=", 
     RowBox[{"AffineTransform", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"Tan", "[", 
           RowBox[{"xAffRatio", "*", "Pi"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Tan", "[", 
           RowBox[{"yAffRatio", "*", "Pi"}], "]"}], ",", "1"}], "}"}]}], 
       "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"transform", "=", 
     RowBox[{"Composition", "[", 
      RowBox[{"rTrans", ",", "affTrans", ",", "scTrans"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Region", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}], "&"}], "@", 
     RowBox[{"TransformedRegion", "[", 
      RowBox[{
       RowBox[{"listRegion", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "transform"}], "]"}]}]}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", 
     RowBox[{"Range", "@", 
      RowBox[{"Length", "@", "listRegion"}]}]}], "}"}], ",", "nSample"}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.805531572388966*^9, {3.805531611789708*^9, 3.80553162818221*^9}, {
   3.8055316620649967`*^9, 3.805531663064323*^9}, {3.805531802558936*^9, 
   3.805531804716776*^9}, {3.805532272258705*^9, 3.8055322837413177`*^9}, {
   3.805532359859715*^9, 3.805532395660103*^9}, {3.805532462797406*^9, 
   3.80553250163982*^9}, 3.8055325365312138`*^9, {3.805532569018488*^9, 
   3.805532579702979*^9}, {3.805532617007375*^9, 3.8055327359869204`*^9}, {
   3.805533101949527*^9, 3.8055331052678347`*^9}, {3.805533190769019*^9, 
   3.805533206123437*^9}, {3.805534211705756*^9, 3.805534214161626*^9}, {
   3.805534682866811*^9, 3.8055346847242393`*^9}, {3.8055347357021*^9, 
   3.805534761875548*^9}},
 CellLabel->"In[302]:=",ExpressionUUID->"c0b6359f-655a-4fef-9903-632a1d921ef5"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (2019\:5e745\:67083\:65e5)",
StyleDefinitions->"Default.nb"
]

